<Window x:Class="IndiLogs_3._0.Views.HelpWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="IndiLogs 3.0 - User Guide" Height="750" Width="900"
        WindowStartupLocation="CenterScreen"
        Background="{DynamicResource BgDark}">

    <Window.Resources>
        <Style TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Foreground" Value="{DynamicResource TextSecondary}"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
            <Setter Property="Margin" Value="0,0,0,10"/>
        </Style>
        <Style TargetType="Run">
            <Setter Property="Foreground" Value="{DynamicResource TextPrimary}"/>
            <Setter Property="FontWeight" Value="Bold"/>
        </Style>
        <Style x:Key="HeaderStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="{DynamicResource PrimaryColor}"/>
            <Setter Property="Margin" Value="0,15,0,5"/>
        </Style>
        <Style x:Key="SubHeaderStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="15"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="{DynamicResource TextPrimary}"/>
            <Setter Property="Margin" Value="0,10,0,5"/>
        </Style>
        <Style x:Key="CodeStyle" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Consolas"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Background" Value="{DynamicResource BgCard}"/>
            <Setter Property="Foreground" Value="{DynamicResource SuccessColor}"/>
            <Setter Property="Padding" Value="8,4"/>
            <Setter Property="Margin" Value="10,2,0,2"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <TabControl Grid.Row="0" Margin="10" Background="Transparent" BorderThickness="0">

            <!-- Tab 1: General & Marking -->
            <TabItem Header="General &amp; Marking">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="10">
                    <StackPanel>
                        <TextBlock Text="Search (Ctrl + F)" Style="{StaticResource HeaderStyle}"/>
                        <TextBlock>
                            ‚Ä¢ Press <Run>Ctrl + F</Run> to open the Quick Search bar.<LineBreak/>
                            ‚Ä¢ Type at least <Run>2 characters</Run> to start filtering.<LineBreak/>
                            ‚Ä¢ The search has a smart delay (0.5s) to prevent lag while typing.<LineBreak/>
                            ‚Ä¢ Only rows containing the search term (in Message or Thread) will be shown.<LineBreak/>
                            ‚Ä¢ Matching text is automatically <Run>Highlighted in Yellow</Run>.
                        </TextBlock>

                        <TextBlock Text="Marking Rows" Style="{StaticResource HeaderStyle}"/>
                        <TextBlock>
                            ‚Ä¢ <Run>Spacebar:</Run> Select any row and press Space to Mark/Unmark it.<LineBreak/>
                            ‚Ä¢ Marked rows are highlighted in <Run>Purple</Run>.<LineBreak/>
                            ‚Ä¢ Use the <Run>‚¨Ü / ‚¨á</Run> buttons in the top toolbar to jump between marked lines.
                        </TextBlock>

                        <TextBlock Text="Marked Lines Window" Style="{StaticResource HeaderStyle}"/>
                        <TextBlock>
                            ‚Ä¢ Click the <Run>üìå Marked Lines</Run> button to open a summary window.<LineBreak/>
                            ‚Ä¢ Displays Time, Thread, and Message of all marked lines.<LineBreak/>
                            ‚Ä¢ <Run>Double-Click:</Run> Jumps to the specific line in the main log.<LineBreak/>
                            ‚Ä¢ <Run>Multi-Select:</Run> Use Ctrl/Shift to select multiple lines.<LineBreak/>
                            ‚Ä¢ <Run>Copy (Ctrl+C):</Run> Copies selected lines to clipboard with clean formatting (aligned columns).<LineBreak/>
                            ‚Ä¢ <Run>Select All (Ctrl+A):</Run> Selects all marked lines in the list.
                        </TextBlock>

                        <TextBlock Text="Keyboard Shortcuts" Style="{StaticResource HeaderStyle}"/>
                        <TextBlock>
                            ‚Ä¢ <Run>Ctrl+F:</Run> Open/close search panel<LineBreak/>
                            ‚Ä¢ <Run>Esc:</Run> Close search panel<LineBreak/>
                            ‚Ä¢ <Run>Spacebar:</Run> Mark/unmark selected row<LineBreak/>
                            ‚Ä¢ <Run>Ctrl+Z:</Run> Undo last filter out action<LineBreak/>
                            ‚Ä¢ <Run>Ctrl++:</Run> Zoom in<LineBreak/>
                            ‚Ä¢ <Run>Ctrl+-:</Run> Zoom out
                        </TextBlock>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Tab 2: Filtering -->
            <TabItem Header="Filtering">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="10">
                    <StackPanel>
                        <TextBlock Text="Filtering Overview" Style="{StaticResource HeaderStyle}"/>
                        <TextBlock>
                            IndiLogs supports both positive filtering (show only matching) and negative filtering (hide matching).
                        </TextBlock>

                        <TextBlock Text="Quick Filter" Style="{StaticResource SubHeaderStyle}"/>
                        <TextBlock>
                            ‚Ä¢ <Run>Filter (Checkbox):</Run> Toggles positive filtering ON/OFF.<LineBreak/>
                            ‚Ä¢ <Run>Filter Out (Checkbox):</Run> Toggles negative filtering (hiding rows) ON/OFF.
                        </TextBlock>

                        <TextBlock Text="Advanced Filter Editor" Style="{StaticResource SubHeaderStyle}"/>
                        <TextBlock>
                            Click <Run>üîç Filter...</Run> button to open the Advanced Filter Editor:
                        </TextBlock>
                        <TextBlock>
                            ‚Ä¢ Build complex filter logic using a <Run>tree structure</Run><LineBreak/>
                            ‚Ä¢ Combine conditions with <Run>AND / OR / NOT</Run> operators<LineBreak/>
                            ‚Ä¢ Create nested groups for complex logic<LineBreak/>
                            ‚Ä¢ Supported fields: Message, Level, ThreadName, Logger, Method, Pattern, Data, Exception<LineBreak/>
                            ‚Ä¢ Operators: Contains, Equals, Begins With, Ends With, <Run>Regex</Run>
                        </TextBlock>

                        <TextBlock Text="Time Focus Filter" Style="{StaticResource SubHeaderStyle}"/>
                        <TextBlock>
                            ‚Ä¢ Located in the <Run>Right-Click Menu</Run> of any log line.<LineBreak/>
                            ‚Ä¢ Use the <Run>Slider</Run> in Settings to define the range (e.g., 10 sec).<LineBreak/>
                            ‚Ä¢ Shows ALL logs (from all threads) within +/- X seconds of the selected line.
                        </TextBlock>

                        <TextBlock Text="Thread Filtering" Style="{StaticResource SubHeaderStyle}"/>
                        <TextBlock>
                            ‚Ä¢ <Run>Header Filter (‚ñº):</Run> Click the arrow in the 'Thread' column header.<LineBreak/>
                            ‚Ä¢ Supports <Run>Multi-Select</Run>. Use 'Clear' button to reset.<LineBreak/>
                            ‚Ä¢ <Run>Filter Out Thread:</Run> Right-click ‚Üí 'Filter Out (Thread)...' to hide all logs from that thread.
                        </TextBlock>

                        <TextBlock Text="Message Filtering" Style="{StaticResource SubHeaderStyle}"/>
                        <TextBlock>
                            ‚Ä¢ <Run>Filter Out (Message):</Run> Right-click ‚Üí 'Filter Out (Message)...'<LineBreak/>
                            ‚Ä¢ Hides rows containing a specific text string.<LineBreak/>
                            ‚Ä¢ Useful for hiding spam or irrelevant errors.
                        </TextBlock>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Tab 3: Coloring -->
            <TabItem Header="Coloring">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="10">
                    <StackPanel>
                        <TextBlock Text="Custom Coloring" Style="{StaticResource HeaderStyle}"/>
                        <TextBlock>
                            Click <Run>üé® Color...</Run> to define highlighting rules for log entries.
                        </TextBlock>

                        <TextBlock Text="Creating Rules" Style="{StaticResource SubHeaderStyle}"/>
                        <TextBlock>
                            Each coloring rule consists of:<LineBreak/>
                            ‚Ä¢ <Run>Field:</Run> Which field to match (Message, Thread, Level, Logger)<LineBreak/>
                            ‚Ä¢ <Run>Operator:</Run> How to match (Contains, Equals, Starts With, Ends With, Regex)<LineBreak/>
                            ‚Ä¢ <Run>Value:</Run> The text/pattern to match<LineBreak/>
                            ‚Ä¢ <Run>Color:</Run> The highlight color for matching rows
                        </TextBlock>

                        <TextBlock Text="Default Colors" Style="{StaticResource SubHeaderStyle}"/>
                        <TextBlock>
                            Built-in coloring rules are automatically applied:<LineBreak/>
                            ‚Ä¢ <Run>Errors:</Run> Red highlighting<LineBreak/>
                            ‚Ä¢ <Run>PlcMngr state transitions (‚Üí):</Run> Light Blue<LineBreak/>
                            ‚Ä¢ <Run>MechInit:</Run> Orange<LineBreak/>
                            ‚Ä¢ <Run>GetReady:</Run> Light Green<LineBreak/>
                            ‚Ä¢ <Run>Print:</Run> Green
                        </TextBlock>

                        <TextBlock Text="Regex Support" Style="{StaticResource SubHeaderStyle}"/>
                        <TextBlock>
                            Use regular expressions for powerful pattern matching:
                        </TextBlock>
                        <TextBlock Style="{StaticResource CodeStyle}" Text="Error.*timeout"/>
                        <TextBlock Style="{StaticResource CodeStyle}" Text="State: (Init|Ready|Running)"/>
                        <TextBlock Style="{StaticResource CodeStyle}" Text="ID:\s*\d+"/>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Tab 4: Compare -->
            <TabItem Header="Compare">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="10">
                    <StackPanel>
                        <TextBlock Text="Log Comparison Tool" Style="{StaticResource HeaderStyle}"/>
                        <TextBlock>
                            The Compare feature allows side-by-side comparison of logs from different sources.
                        </TextBlock>

                        <TextBlock Text="Opening Compare Window" Style="{StaticResource SubHeaderStyle}"/>
                        <TextBlock>
                            ‚Ä¢ Click the <Run>Compare</Run> button in the toolbar<LineBreak/>
                            ‚Ä¢ Select source types for left and right panes (PLC, APP, by Thread, etc.)
                        </TextBlock>

                        <TextBlock Text="Show Diffs" Style="{StaticResource SubHeaderStyle}"/>
                        <TextBlock>
                            ‚Ä¢ Enable <Run>Show Diffs</Run> checkbox to highlight differences<LineBreak/>
                            ‚Ä¢ <Run>Green background:</Run> Added content (in right pane)<LineBreak/>
                            ‚Ä¢ <Run>Red background with strikethrough:</Run> Removed content (from left pane)<LineBreak/>
                            ‚Ä¢ Differences are shown at character level
                        </TextBlock>

                        <TextBlock Text="Ignore Pattern" Style="{StaticResource SubHeaderStyle}"/>
                        <TextBlock>
                            Use regex patterns to ignore dynamic content during comparison:
                        </TextBlock>
                        <TextBlock Style="{StaticResource CodeStyle}" Text="\d+                    ‚Üí Ignore all numbers"/>
                        <TextBlock Style="{StaticResource CodeStyle}" Text="[a-f0-9\-]{36}         ‚Üí Ignore GUIDs"/>
                        <TextBlock Style="{StaticResource CodeStyle}" Text="\d{2}:\d{2}:\d{2}      ‚Üí Ignore timestamps"/>
                        <TextBlock Style="{StaticResource CodeStyle}" Text="0x[0-9a-fA-F]+         ‚Üí Ignore hex addresses"/>
                        <TextBlock Style="{StaticResource CodeStyle}" Text="\[.*?\]               ‚Üí Ignore bracketed content"/>
                        <TextBlock>
                            <LineBreak/>
                            <Run>Tip:</Run> Combine patterns with | (pipe): <Run>\d+|[a-f0-9\-]{36}</Run><LineBreak/>
                            Red border indicates an invalid regex pattern.
                        </TextBlock>

                        <TextBlock Text="Synchronized Scrolling" Style="{StaticResource SubHeaderStyle}"/>
                        <TextBlock>
                            ‚Ä¢ Enable <Run>Sync ON</Run> to synchronize scrolling between panes<LineBreak/>
                            ‚Ä¢ Synchronization is based on <Run>timestamp matching</Run><LineBreak/>
                            ‚Ä¢ When you scroll one pane, the other automatically scrolls to the nearest matching time<LineBreak/>
                            ‚Ä¢ Selecting a log on one side selects the corresponding log on the other
                        </TextBlock>

                        <TextBlock Text="Delta Display" Style="{StaticResource SubHeaderStyle}"/>
                        <TextBlock>
                            The center column shows the time difference between selected logs:<LineBreak/>
                            ‚Ä¢ <Run>Green:</Run> Times are very close (&lt; 100ms)<LineBreak/>
                            ‚Ä¢ <Run>Yellow:</Run> Times are somewhat close (&lt; 1s)<LineBreak/>
                            ‚Ä¢ <Run>Red:</Run> Times are far apart (&gt; 1s)
                        </TextBlock>

                        <TextBlock Text="Navigation" Style="{StaticResource SubHeaderStyle}"/>
                        <TextBlock>
                            ‚Ä¢ <Run>Double-click:</Run> Jump to selected log in main window<LineBreak/>
                            ‚Ä¢ <Run>Enter:</Run> Jump to selected log in main window<LineBreak/>
                            ‚Ä¢ <Run>Spacebar:</Run> Mark/unmark selected log
                        </TextBlock>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Tab 5: Analysis Tools -->
            <TabItem Header="Analysis Tools">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="10">
                    <StackPanel>
                        <TextBlock Text="Stats Window" Style="{StaticResource HeaderStyle}"/>
                        <TextBlock>
                            Click <Run>üìä Stats</Run> to open statistical analysis:
                        </TextBlock>
                        <TextBlock>
                            ‚Ä¢ <Run>Error Histogram:</Run> Top 10 most common errors<LineBreak/>
                            ‚Ä¢ <Run>Thread Load:</Run> Distribution of logs by thread<LineBreak/>
                            ‚Ä¢ <Run>Time Gaps:</Run> Identifies gaps of 2+ seconds in the log<LineBreak/>
                            ‚Ä¢ <Run>Logger Distribution:</Run> Top 15 loggers by activity<LineBreak/>
                            ‚Ä¢ <Run>Timeline Chart:</Run> Error density over time<LineBreak/>
                            ‚Ä¢ Click chart elements to apply filters
                        </TextBlock>

                        <TextBlock Text="States Window" Style="{StaticResource HeaderStyle}"/>
                        <TextBlock>
                            Click <Run>States</Run> to view PLC state machine transitions:
                        </TextBlock>
                        <TextBlock>
                            ‚Ä¢ Shows state transitions in chronological order<LineBreak/>
                            ‚Ä¢ Displays transition title (From ‚Üí To)<LineBreak/>
                            ‚Ä¢ Calculates duration of each state<LineBreak/>
                            ‚Ä¢ Useful for understanding system workflow
                        </TextBlock>

                        <TextBlock Text="Failures Analysis" Style="{StaticResource HeaderStyle}"/>
                        <TextBlock>
                            Click <Run>Failures</Run> to analyze critical failure events:
                        </TextBlock>
                        <TextBlock>
                            ‚Ä¢ Identifies critical failure patterns<LineBreak/>
                            ‚Ä¢ Finds the last state transition before failure<LineBreak/>
                            ‚Ä¢ Calculates duration until failure occurred<LineBreak/>
                            ‚Ä¢ Collects all errors within the failure window
                        </TextBlock>

                        <TextBlock Text="Global Grep" Style="{StaticResource HeaderStyle}"/>
                        <TextBlock>
                            Click <Run>üîç Global Grep</Run> for cross-session search:
                        </TextBlock>
                        <TextBlock>
                            ‚Ä¢ Search across multiple loaded sessions<LineBreak/>
                            ‚Ä¢ Search external files (ZIP archives, directories)<LineBreak/>
                            ‚Ä¢ Supports regex and boolean operators (AND/OR/NOT)<LineBreak/>
                            ‚Ä¢ Field-specific search: Message, Exception, Method, Data<LineBreak/>
                            ‚Ä¢ Click results to navigate to matching logs
                        </TextBlock>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Tab 6: Cases & Configs -->
            <TabItem Header="Cases &amp; Configs">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="10">
                    <StackPanel>
                        <TextBlock Text="Case Management" Style="{StaticResource HeaderStyle}"/>
                        <TextBlock>
                            Save and load investigation cases as <Run>.indi-case</Run> files:
                        </TextBlock>
                        <TextBlock>
                            ‚Ä¢ <Run>Save Case:</Run> Saves current investigation state<LineBreak/>
                            ‚Ä¢ <Run>Load Case:</Run> Restores a previously saved case
                        </TextBlock>

                        <TextBlock Text="What's Saved in a Case" Style="{StaticResource SubHeaderStyle}"/>
                        <TextBlock>
                            ‚Ä¢ Case metadata (author, date, description)<LineBreak/>
                            ‚Ä¢ References to log files<LineBreak/>
                            ‚Ä¢ Active filters and search settings<LineBreak/>
                            ‚Ä¢ Coloring rules<LineBreak/>
                            ‚Ä¢ Log annotations and notes<LineBreak/>
                            ‚Ä¢ View state (selected tab, thread filters)
                        </TextBlock>

                        <TextBlock Text="Configuration Sets" Style="{StaticResource HeaderStyle}"/>
                        <TextBlock>
                            The <Run>CONFIGS</Run> panel (right side) manages workspace settings:
                        </TextBlock>
                        <TextBlock>
                            ‚Ä¢ <Run>Save:</Run> Saves current Coloring Rules + Advanced Filters to JSON<LineBreak/>
                            ‚Ä¢ <Run>Apply:</Run> Double-click a config to apply it immediately<LineBreak/>
                            ‚Ä¢ <Run>Delete:</Run> Removes the selected configuration<LineBreak/>
                            ‚Ä¢ Configs are stored in: %AppData%\IndiLogs\Configs\
                        </TextBlock>

                        <TextBlock Text="Annotations" Style="{StaticResource SubHeaderStyle}"/>
                        <TextBlock>
                            Add notes to specific log entries:<LineBreak/>
                            ‚Ä¢ Right-click a log ‚Üí <Run>Add Annotation</Run><LineBreak/>
                            ‚Ä¢ Annotated rows are highlighted in <Run>Yellow</Run><LineBreak/>
                            ‚Ä¢ Annotations are saved with cases using "soft linking" (by timestamp/logger/thread)
                        </TextBlock>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Tab 7: User Interface -->
            <TabItem Header="User Interface">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="10">
                    <StackPanel>
                        <TextBlock Text="Window Layout" Style="{StaticResource HeaderStyle}"/>
                        <TextBlock>
                            The main window has three resizable panels:
                        </TextBlock>
                        <TextBlock>
                            ‚Ä¢ <Run>Left Panel:</Run> Session explorer and action buttons<LineBreak/>
                            ‚Ä¢ <Run>Center Panel:</Run> Tab control for log views<LineBreak/>
                            ‚Ä¢ <Run>Right Panel:</Run> Configuration panel<LineBreak/>
                            ‚Ä¢ Use the toggle buttons to show/hide side panels
                        </TextBlock>

                        <TextBlock Text="Log Tabs" Style="{StaticResource SubHeaderStyle}"/>
                        <TextBlock>
                            ‚Ä¢ <Run>LOGS:</Run> Main view showing all loaded logs<LineBreak/>
                            ‚Ä¢ <Run>LOGS (Filtered):</Run> Results of active filters/search<LineBreak/>
                            ‚Ä¢ <Run>APP:</Run> Application logs<LineBreak/>
                            ‚Ä¢ <Run>Timeline:</Run> Visual timeline view<LineBreak/>
                            ‚Ä¢ <Run>States:</Run> State machine visualization<LineBreak/>
                            ‚Ä¢ <Run>Analysis:</Run> Analysis report window
                        </TextBlock>

                        <TextBlock Text="Context Menu" Style="{StaticResource SubHeaderStyle}"/>
                        <TextBlock>
                            Right-click any log entry for options:<LineBreak/>
                            ‚Ä¢ Filter by this thread<LineBreak/>
                            ‚Ä¢ Filter out this thread/message<LineBreak/>
                            ‚Ä¢ Time focus filter<LineBreak/>
                            ‚Ä¢ Add annotation<LineBreak/>
                            ‚Ä¢ Mark/Unmark<LineBreak/>
                            ‚Ä¢ Copy to clipboard
                        </TextBlock>

                        <TextBlock Text="External Tools" Style="{StaticResource SubHeaderStyle}"/>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                            <TextBlock Text="üìà Graph:" Width="80" FontWeight="Bold" Foreground="{DynamicResource TextPrimary}"/>
                            <TextBlock Text="Opens IoRecorderViewer.exe" Margin="0"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                            <TextBlock Text="üü¶ JIRA:" Width="80" FontWeight="Bold" Foreground="{DynamicResource TextPrimary}"/>
                            <TextBlock Text="Opens HP JIRA Dashboard" Margin="0"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                            <TextBlock Text="üüß Kibana:" Width="80" FontWeight="Bold" Foreground="{DynamicResource TextPrimary}"/>
                            <TextBlock Text="Quick link to Kibana logs" Margin="0"/>
                        </StackPanel>

                        <TextBlock Text="Live Monitoring" Style="{StaticResource SubHeaderStyle}"/>
                        <TextBlock>
                            ‚Ä¢ <Run>Drag &amp; Drop</Run> an active log file to start live monitoring<LineBreak/>
                            ‚Ä¢ <Run>‚ñ∂ Play:</Run> Resume auto-scrolling and fetching<LineBreak/>
                            ‚Ä¢ <Run>‚è∏ Pause:</Run> Stop fetching temporarily<LineBreak/>
                            ‚Ä¢ <Run>‚äò Clear:</Run> Reset buffer and start fresh<LineBreak/>
                            ‚Ä¢ Polls the file every 3 seconds for changes
                        </TextBlock>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

        </TabControl>

        <Button Grid.Row="1" Content="Close" Click="Close_Click" Style="{DynamicResource ModernBtn}" HorizontalAlignment="Right" Margin="10" Width="100"/>
    </Grid>
</Window>
